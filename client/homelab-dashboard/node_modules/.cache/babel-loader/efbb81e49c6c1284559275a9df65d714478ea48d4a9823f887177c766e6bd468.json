{"ast":null,"code":"\"use strict\";\n\nconst {\n  domSymbolTree\n} = require(\"./internal-constants\");\nconst reportException = require(\"./runtime-script-errors\");\nconst Event = require(\"../generated/Event\");\nconst idlUtils = require(\"../generated/utils\");\nconst MutationRecord = require(\"../generated/MutationRecord\");\nconst MUTATION_TYPE = {\n  ATTRIBUTES: \"attributes\",\n  CHARACTER_DATA: \"characterData\",\n  CHILD_LIST: \"childList\"\n};\n\n// Note:\n// Since jsdom doesn't currently implement the concept of \"unit of related similar-origin browsing contexts\"\n// (https://html.spec.whatwg.org/multipage/browsers.html#unit-of-related-similar-origin-browsing-contexts)\n// we will approximate that the following properties are global for now.\n\n// https://dom.spec.whatwg.org/#mutation-observer-compound-microtask-queued-flag\nlet mutationObserverMicrotaskQueueFlag = false;\n\n// Non-spec compliant: List of all the mutation observers with mutation records enqueued. It's a replacement for\n// mutation observer list (https://dom.spec.whatwg.org/#mutation-observer-list) but without leaking since it's empty\n// before notifying the mutation observers.\nconst activeMutationObservers = new Set();\n\n// https://dom.spec.whatwg.org/#signal-slot-list\nconst signalSlotList = [];\n\n// https://dom.spec.whatwg.org/#queue-a-mutation-record\nfunction queueMutationRecord(type, target, name, namespace, oldValue, addedNodes, removedNodes, previousSibling, nextSibling) {\n  const interestedObservers = new Map();\n  const nodes = domSymbolTree.ancestorsToArray(target);\n  for (const node of nodes) {\n    for (const registered of node._registeredObserverList) {\n      const {\n        options,\n        observer: mo\n      } = registered;\n      if (!(node !== target && options.subtree === false) && !(type === MUTATION_TYPE.ATTRIBUTES && options.attributes !== true) && !(type === MUTATION_TYPE.ATTRIBUTES && options.attributeFilter && !options.attributeFilter.some(value => value === name || value === namespace)) && !(type === MUTATION_TYPE.CHARACTER_DATA && options.characterData !== true) && !(type === MUTATION_TYPE.CHILD_LIST && options.childList === false)) {\n        if (!interestedObservers.has(mo)) {\n          interestedObservers.set(mo, null);\n        }\n        if (type === MUTATION_TYPE.ATTRIBUTES && options.attributeOldValue === true || type === MUTATION_TYPE.CHARACTER_DATA && options.characterDataOldValue === true) {\n          interestedObservers.set(mo, oldValue);\n        }\n      }\n    }\n  }\n  for (const [observer, mappedOldValue] of interestedObservers.entries()) {\n    const record = MutationRecord.createImpl(target._globalObject, [], {\n      type,\n      target,\n      attributeName: name,\n      attributeNamespace: namespace,\n      oldValue: mappedOldValue,\n      addedNodes,\n      removedNodes,\n      previousSibling,\n      nextSibling\n    });\n    observer._recordQueue.push(record);\n    activeMutationObservers.add(observer);\n  }\n  queueMutationObserverMicrotask();\n}\n\n// https://dom.spec.whatwg.org/#queue-a-tree-mutation-record\nfunction queueTreeMutationRecord(target, addedNodes, removedNodes, previousSibling, nextSibling) {\n  queueMutationRecord(MUTATION_TYPE.CHILD_LIST, target, null, null, null, addedNodes, removedNodes, previousSibling, nextSibling);\n}\n\n// https://dom.spec.whatwg.org/#queue-an-attribute-mutation-record\nfunction queueAttributeMutationRecord(target, name, namespace, oldValue) {\n  queueMutationRecord(MUTATION_TYPE.ATTRIBUTES, target, name, namespace, oldValue, [], [], null, null);\n}\n\n// https://dom.spec.whatwg.org/#queue-a-mutation-observer-compound-microtask\nfunction queueMutationObserverMicrotask() {\n  if (mutationObserverMicrotaskQueueFlag) {\n    return;\n  }\n  mutationObserverMicrotaskQueueFlag = true;\n  Promise.resolve().then(() => {\n    notifyMutationObservers();\n  });\n}\n\n// https://dom.spec.whatwg.org/#notify-mutation-observers\nfunction notifyMutationObservers() {\n  mutationObserverMicrotaskQueueFlag = false;\n  const notifyList = [...activeMutationObservers].sort((a, b) => a._id - b._id);\n  activeMutationObservers.clear();\n  const signalList = [...signalSlotList];\n  signalSlotList.splice(0, signalSlotList.length);\n  for (const mo of notifyList) {\n    const records = [...mo._recordQueue];\n    mo._recordQueue = [];\n    for (const node of mo._nodeList) {\n      node._registeredObserverList = node._registeredObserverList.filter(registeredObserver => {\n        return registeredObserver.source !== mo;\n      });\n    }\n    if (records.length > 0) {\n      try {\n        const moWrapper = idlUtils.wrapperForImpl(mo);\n        mo._callback.call(moWrapper, records.map(idlUtils.wrapperForImpl), moWrapper);\n      } catch (e) {\n        const {\n          target\n        } = records[0];\n        const window = target._ownerDocument._defaultView;\n        reportException(window, e);\n      }\n    }\n  }\n  for (const slot of signalList) {\n    const slotChangeEvent = Event.createImpl(slot._globalObject, [\"slotchange\", {\n      bubbles: true\n    }], {\n      isTrusted: true\n    });\n    slot._dispatch(slotChangeEvent);\n  }\n}\nmodule.exports = {\n  MUTATION_TYPE,\n  queueMutationRecord,\n  queueTreeMutationRecord,\n  queueAttributeMutationRecord,\n  queueMutationObserverMicrotask,\n  signalSlotList\n};","map":{"version":3,"names":["domSymbolTree","require","reportException","Event","idlUtils","MutationRecord","MUTATION_TYPE","ATTRIBUTES","CHARACTER_DATA","CHILD_LIST","mutationObserverMicrotaskQueueFlag","activeMutationObservers","Set","signalSlotList","queueMutationRecord","type","target","name","namespace","oldValue","addedNodes","removedNodes","previousSibling","nextSibling","interestedObservers","Map","nodes","ancestorsToArray","node","registered","_registeredObserverList","options","observer","mo","subtree","attributes","attributeFilter","some","value","characterData","childList","has","set","attributeOldValue","characterDataOldValue","mappedOldValue","entries","record","createImpl","_globalObject","attributeName","attributeNamespace","_recordQueue","push","add","queueMutationObserverMicrotask","queueTreeMutationRecord","queueAttributeMutationRecord","Promise","resolve","then","notifyMutationObservers","notifyList","sort","a","b","_id","clear","signalList","splice","length","records","_nodeList","filter","registeredObserver","source","moWrapper","wrapperForImpl","_callback","call","map","e","window","_ownerDocument","_defaultView","slot","slotChangeEvent","bubbles","isTrusted","_dispatch","module","exports"],"sources":["D:/benki/Programming/GitHub/homelab-dashboard/client/homelab-dashboard/node_modules/jsdom/lib/jsdom/living/helpers/mutation-observers.js"],"sourcesContent":["\"use strict\";\n\nconst { domSymbolTree } = require(\"./internal-constants\");\nconst reportException = require(\"./runtime-script-errors\");\n\nconst Event = require(\"../generated/Event\");\nconst idlUtils = require(\"../generated/utils\");\nconst MutationRecord = require(\"../generated/MutationRecord\");\n\nconst MUTATION_TYPE = {\n  ATTRIBUTES: \"attributes\",\n  CHARACTER_DATA: \"characterData\",\n  CHILD_LIST: \"childList\"\n};\n\n// Note:\n// Since jsdom doesn't currently implement the concept of \"unit of related similar-origin browsing contexts\"\n// (https://html.spec.whatwg.org/multipage/browsers.html#unit-of-related-similar-origin-browsing-contexts)\n// we will approximate that the following properties are global for now.\n\n// https://dom.spec.whatwg.org/#mutation-observer-compound-microtask-queued-flag\nlet mutationObserverMicrotaskQueueFlag = false;\n\n// Non-spec compliant: List of all the mutation observers with mutation records enqueued. It's a replacement for\n// mutation observer list (https://dom.spec.whatwg.org/#mutation-observer-list) but without leaking since it's empty\n// before notifying the mutation observers.\nconst activeMutationObservers = new Set();\n\n// https://dom.spec.whatwg.org/#signal-slot-list\nconst signalSlotList = [];\n\n// https://dom.spec.whatwg.org/#queue-a-mutation-record\nfunction queueMutationRecord(\n  type,\n  target,\n  name,\n  namespace,\n  oldValue,\n  addedNodes,\n  removedNodes,\n  previousSibling,\n  nextSibling\n) {\n  const interestedObservers = new Map();\n\n  const nodes = domSymbolTree.ancestorsToArray(target);\n\n  for (const node of nodes) {\n    for (const registered of node._registeredObserverList) {\n      const { options, observer: mo } = registered;\n\n      if (\n        !(node !== target && options.subtree === false) &&\n        !(type === MUTATION_TYPE.ATTRIBUTES && options.attributes !== true) &&\n        !(type === MUTATION_TYPE.ATTRIBUTES && options.attributeFilter &&\n          !options.attributeFilter.some(value => value === name || value === namespace)) &&\n        !(type === MUTATION_TYPE.CHARACTER_DATA && options.characterData !== true) &&\n        !(type === MUTATION_TYPE.CHILD_LIST && options.childList === false)\n      ) {\n        if (!interestedObservers.has(mo)) {\n          interestedObservers.set(mo, null);\n        }\n\n        if (\n          (type === MUTATION_TYPE.ATTRIBUTES && options.attributeOldValue === true) ||\n          (type === MUTATION_TYPE.CHARACTER_DATA && options.characterDataOldValue === true)\n        ) {\n          interestedObservers.set(mo, oldValue);\n        }\n      }\n    }\n  }\n\n  for (const [observer, mappedOldValue] of interestedObservers.entries()) {\n    const record = MutationRecord.createImpl(target._globalObject, [], {\n      type,\n      target,\n      attributeName: name,\n      attributeNamespace: namespace,\n      oldValue: mappedOldValue,\n      addedNodes,\n      removedNodes,\n      previousSibling,\n      nextSibling\n    });\n\n    observer._recordQueue.push(record);\n    activeMutationObservers.add(observer);\n  }\n\n  queueMutationObserverMicrotask();\n}\n\n// https://dom.spec.whatwg.org/#queue-a-tree-mutation-record\nfunction queueTreeMutationRecord(target, addedNodes, removedNodes, previousSibling, nextSibling) {\n  queueMutationRecord(\n    MUTATION_TYPE.CHILD_LIST,\n    target,\n    null,\n    null,\n    null,\n    addedNodes,\n    removedNodes,\n    previousSibling,\n    nextSibling\n  );\n}\n\n// https://dom.spec.whatwg.org/#queue-an-attribute-mutation-record\nfunction queueAttributeMutationRecord(target, name, namespace, oldValue) {\n  queueMutationRecord(\n    MUTATION_TYPE.ATTRIBUTES,\n    target,\n    name,\n    namespace,\n    oldValue,\n    [],\n    [],\n    null,\n    null\n  );\n}\n\n// https://dom.spec.whatwg.org/#queue-a-mutation-observer-compound-microtask\nfunction queueMutationObserverMicrotask() {\n  if (mutationObserverMicrotaskQueueFlag) {\n    return;\n  }\n\n  mutationObserverMicrotaskQueueFlag = true;\n\n  Promise.resolve().then(() => {\n    notifyMutationObservers();\n  });\n}\n\n// https://dom.spec.whatwg.org/#notify-mutation-observers\nfunction notifyMutationObservers() {\n  mutationObserverMicrotaskQueueFlag = false;\n\n  const notifyList = [...activeMutationObservers].sort((a, b) => a._id - b._id);\n  activeMutationObservers.clear();\n\n  const signalList = [...signalSlotList];\n  signalSlotList.splice(0, signalSlotList.length);\n\n  for (const mo of notifyList) {\n    const records = [...mo._recordQueue];\n    mo._recordQueue = [];\n\n    for (const node of mo._nodeList) {\n      node._registeredObserverList = node._registeredObserverList.filter(registeredObserver => {\n        return registeredObserver.source !== mo;\n      });\n    }\n\n    if (records.length > 0) {\n      try {\n        const moWrapper = idlUtils.wrapperForImpl(mo);\n        mo._callback.call(\n          moWrapper,\n          records.map(idlUtils.wrapperForImpl),\n          moWrapper\n        );\n      } catch (e) {\n        const { target } = records[0];\n        const window = target._ownerDocument._defaultView;\n\n        reportException(window, e);\n      }\n    }\n  }\n\n  for (const slot of signalList) {\n    const slotChangeEvent = Event.createImpl(\n      slot._globalObject,\n      [\n        \"slotchange\",\n        { bubbles: true }\n      ],\n      { isTrusted: true }\n    );\n\n    slot._dispatch(slotChangeEvent);\n  }\n}\n\nmodule.exports = {\n  MUTATION_TYPE,\n\n  queueMutationRecord,\n  queueTreeMutationRecord,\n  queueAttributeMutationRecord,\n\n  queueMutationObserverMicrotask,\n\n  signalSlotList\n};\n"],"mappings":"AAAA,YAAY;;AAEZ,MAAM;EAAEA;AAAc,CAAC,GAAGC,OAAO,CAAC,sBAAsB,CAAC;AACzD,MAAMC,eAAe,GAAGD,OAAO,CAAC,yBAAyB,CAAC;AAE1D,MAAME,KAAK,GAAGF,OAAO,CAAC,oBAAoB,CAAC;AAC3C,MAAMG,QAAQ,GAAGH,OAAO,CAAC,oBAAoB,CAAC;AAC9C,MAAMI,cAAc,GAAGJ,OAAO,CAAC,6BAA6B,CAAC;AAE7D,MAAMK,aAAa,GAAG;EACpBC,UAAU,EAAE,YAAY;EACxBC,cAAc,EAAE,eAAe;EAC/BC,UAAU,EAAE;AACd,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA,IAAIC,kCAAkC,GAAG,KAAK;;AAE9C;AACA;AACA;AACA,MAAMC,uBAAuB,GAAG,IAAIC,GAAG,CAAC,CAAC;;AAEzC;AACA,MAAMC,cAAc,GAAG,EAAE;;AAEzB;AACA,SAASC,mBAAmBA,CAC1BC,IAAI,EACJC,MAAM,EACNC,IAAI,EACJC,SAAS,EACTC,QAAQ,EACRC,UAAU,EACVC,YAAY,EACZC,eAAe,EACfC,WAAW,EACX;EACA,MAAMC,mBAAmB,GAAG,IAAIC,GAAG,CAAC,CAAC;EAErC,MAAMC,KAAK,GAAG1B,aAAa,CAAC2B,gBAAgB,CAACX,MAAM,CAAC;EAEpD,KAAK,MAAMY,IAAI,IAAIF,KAAK,EAAE;IACxB,KAAK,MAAMG,UAAU,IAAID,IAAI,CAACE,uBAAuB,EAAE;MACrD,MAAM;QAAEC,OAAO;QAAEC,QAAQ,EAAEC;MAAG,CAAC,GAAGJ,UAAU;MAE5C,IACE,EAAED,IAAI,KAAKZ,MAAM,IAAIe,OAAO,CAACG,OAAO,KAAK,KAAK,CAAC,IAC/C,EAAEnB,IAAI,KAAKT,aAAa,CAACC,UAAU,IAAIwB,OAAO,CAACI,UAAU,KAAK,IAAI,CAAC,IACnE,EAAEpB,IAAI,KAAKT,aAAa,CAACC,UAAU,IAAIwB,OAAO,CAACK,eAAe,IAC5D,CAACL,OAAO,CAACK,eAAe,CAACC,IAAI,CAACC,KAAK,IAAIA,KAAK,KAAKrB,IAAI,IAAIqB,KAAK,KAAKpB,SAAS,CAAC,CAAC,IAChF,EAAEH,IAAI,KAAKT,aAAa,CAACE,cAAc,IAAIuB,OAAO,CAACQ,aAAa,KAAK,IAAI,CAAC,IAC1E,EAAExB,IAAI,KAAKT,aAAa,CAACG,UAAU,IAAIsB,OAAO,CAACS,SAAS,KAAK,KAAK,CAAC,EACnE;QACA,IAAI,CAAChB,mBAAmB,CAACiB,GAAG,CAACR,EAAE,CAAC,EAAE;UAChCT,mBAAmB,CAACkB,GAAG,CAACT,EAAE,EAAE,IAAI,CAAC;QACnC;QAEA,IACGlB,IAAI,KAAKT,aAAa,CAACC,UAAU,IAAIwB,OAAO,CAACY,iBAAiB,KAAK,IAAI,IACvE5B,IAAI,KAAKT,aAAa,CAACE,cAAc,IAAIuB,OAAO,CAACa,qBAAqB,KAAK,IAAK,EACjF;UACApB,mBAAmB,CAACkB,GAAG,CAACT,EAAE,EAAEd,QAAQ,CAAC;QACvC;MACF;IACF;EACF;EAEA,KAAK,MAAM,CAACa,QAAQ,EAAEa,cAAc,CAAC,IAAIrB,mBAAmB,CAACsB,OAAO,CAAC,CAAC,EAAE;IACtE,MAAMC,MAAM,GAAG1C,cAAc,CAAC2C,UAAU,CAAChC,MAAM,CAACiC,aAAa,EAAE,EAAE,EAAE;MACjElC,IAAI;MACJC,MAAM;MACNkC,aAAa,EAAEjC,IAAI;MACnBkC,kBAAkB,EAAEjC,SAAS;MAC7BC,QAAQ,EAAE0B,cAAc;MACxBzB,UAAU;MACVC,YAAY;MACZC,eAAe;MACfC;IACF,CAAC,CAAC;IAEFS,QAAQ,CAACoB,YAAY,CAACC,IAAI,CAACN,MAAM,CAAC;IAClCpC,uBAAuB,CAAC2C,GAAG,CAACtB,QAAQ,CAAC;EACvC;EAEAuB,8BAA8B,CAAC,CAAC;AAClC;;AAEA;AACA,SAASC,uBAAuBA,CAACxC,MAAM,EAAEI,UAAU,EAAEC,YAAY,EAAEC,eAAe,EAAEC,WAAW,EAAE;EAC/FT,mBAAmB,CACjBR,aAAa,CAACG,UAAU,EACxBO,MAAM,EACN,IAAI,EACJ,IAAI,EACJ,IAAI,EACJI,UAAU,EACVC,YAAY,EACZC,eAAe,EACfC,WACF,CAAC;AACH;;AAEA;AACA,SAASkC,4BAA4BA,CAACzC,MAAM,EAAEC,IAAI,EAAEC,SAAS,EAAEC,QAAQ,EAAE;EACvEL,mBAAmB,CACjBR,aAAa,CAACC,UAAU,EACxBS,MAAM,EACNC,IAAI,EACJC,SAAS,EACTC,QAAQ,EACR,EAAE,EACF,EAAE,EACF,IAAI,EACJ,IACF,CAAC;AACH;;AAEA;AACA,SAASoC,8BAA8BA,CAAA,EAAG;EACxC,IAAI7C,kCAAkC,EAAE;IACtC;EACF;EAEAA,kCAAkC,GAAG,IAAI;EAEzCgD,OAAO,CAACC,OAAO,CAAC,CAAC,CAACC,IAAI,CAAC,MAAM;IAC3BC,uBAAuB,CAAC,CAAC;EAC3B,CAAC,CAAC;AACJ;;AAEA;AACA,SAASA,uBAAuBA,CAAA,EAAG;EACjCnD,kCAAkC,GAAG,KAAK;EAE1C,MAAMoD,UAAU,GAAG,CAAC,GAAGnD,uBAAuB,CAAC,CAACoD,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACE,GAAG,GAAGD,CAAC,CAACC,GAAG,CAAC;EAC7EvD,uBAAuB,CAACwD,KAAK,CAAC,CAAC;EAE/B,MAAMC,UAAU,GAAG,CAAC,GAAGvD,cAAc,CAAC;EACtCA,cAAc,CAACwD,MAAM,CAAC,CAAC,EAAExD,cAAc,CAACyD,MAAM,CAAC;EAE/C,KAAK,MAAMrC,EAAE,IAAI6B,UAAU,EAAE;IAC3B,MAAMS,OAAO,GAAG,CAAC,GAAGtC,EAAE,CAACmB,YAAY,CAAC;IACpCnB,EAAE,CAACmB,YAAY,GAAG,EAAE;IAEpB,KAAK,MAAMxB,IAAI,IAAIK,EAAE,CAACuC,SAAS,EAAE;MAC/B5C,IAAI,CAACE,uBAAuB,GAAGF,IAAI,CAACE,uBAAuB,CAAC2C,MAAM,CAACC,kBAAkB,IAAI;QACvF,OAAOA,kBAAkB,CAACC,MAAM,KAAK1C,EAAE;MACzC,CAAC,CAAC;IACJ;IAEA,IAAIsC,OAAO,CAACD,MAAM,GAAG,CAAC,EAAE;MACtB,IAAI;QACF,MAAMM,SAAS,GAAGxE,QAAQ,CAACyE,cAAc,CAAC5C,EAAE,CAAC;QAC7CA,EAAE,CAAC6C,SAAS,CAACC,IAAI,CACfH,SAAS,EACTL,OAAO,CAACS,GAAG,CAAC5E,QAAQ,CAACyE,cAAc,CAAC,EACpCD,SACF,CAAC;MACH,CAAC,CAAC,OAAOK,CAAC,EAAE;QACV,MAAM;UAAEjE;QAAO,CAAC,GAAGuD,OAAO,CAAC,CAAC,CAAC;QAC7B,MAAMW,MAAM,GAAGlE,MAAM,CAACmE,cAAc,CAACC,YAAY;QAEjDlF,eAAe,CAACgF,MAAM,EAAED,CAAC,CAAC;MAC5B;IACF;EACF;EAEA,KAAK,MAAMI,IAAI,IAAIjB,UAAU,EAAE;IAC7B,MAAMkB,eAAe,GAAGnF,KAAK,CAAC6C,UAAU,CACtCqC,IAAI,CAACpC,aAAa,EAClB,CACE,YAAY,EACZ;MAAEsC,OAAO,EAAE;IAAK,CAAC,CAClB,EACD;MAAEC,SAAS,EAAE;IAAK,CACpB,CAAC;IAEDH,IAAI,CAACI,SAAS,CAACH,eAAe,CAAC;EACjC;AACF;AAEAI,MAAM,CAACC,OAAO,GAAG;EACfrF,aAAa;EAEbQ,mBAAmB;EACnB0C,uBAAuB;EACvBC,4BAA4B;EAE5BF,8BAA8B;EAE9B1C;AACF,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}